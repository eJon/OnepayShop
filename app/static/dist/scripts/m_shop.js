require(["jquery","vendor/scroll_load","jquery-downcount"],function(n,a){function t(a){var t=n(".count-list").find("span");t.removeClass("active"),n.each(t,function(){n(this).data("value")==a&&n(this).addClass("active")})}function i(){var a=Number(n('input[name="amount"]').val()),t=Number(n('input[name="pid"]').val()),i=Number(n(".join-select").find(".plus").data("max"));if("NaN"!=a.toString()&&"NaN"!=t.toString()&&0!=t&&"NaN"!=i.toString()){if(a>=1&&a<=i)return!0;n('input[name="amount"]').focus()}}function o(){return!!n("body").hasClass("login")}var e={bind:function(){n("#container").on("click","#showActionSheet",function(){function a(n,a){n.removeClass("weui_actionsheet_toggle"),a.removeClass("weui_fade_toggle"),a.on("transitionend",function(){a.hide()}).on("webkitTransitionEnd",function(){a.hide()})}var t=n("#mask"),i=n("#weui_actionsheet");i.addClass("weui_actionsheet_toggle"),t.show().focus().addClass("weui_fade_toggle").one("click",function(){a(i,t)}),n("#actionsheet_cancel").one("click",function(){a(i,t)}),t.unbind("transitionend").unbind("webkitTransitionEnd")})}};e.bind();var l={bind:function(){n(".m-shop").on("click",".view-num",function(){var a=n(this),t=a.data("num").toString();if(a.data("zj")){var i="<strong>"+a.data("zj")+"</strong>";t=t.replace(a.data("zj"),i)}n("#num_dialog").find(".weui_dialog_bd").html(t),n("#num_dialog").show().on("click",".weui_btn_dialog",function(){n("#num_dialog").off("click").hide()})})}};l.bind();var u=n(".count-down"),c=n(".diff-now");u.length>0&&u.downCount({finish:new Date(c.data("finish")).getTime(),now:1e3*parseFloat(c.data("now"))},function(){u.find("span").text("0"),location.reload()}),n('input[name="amount"]').on("keyup",function(){var a=n(this);1==a.val().length?a.val(a.val().replace(/[^1-9]/g,"1")):a.val(a.val().replace(/\D/g,"1")),t(a.val())}),n('input[name="amount"]').on("afterpaste",function(){var a=n(this);1==a.val().length?a.val(a.val().replace(/[^1-9]/g,"1")):a.val(a.val().replace(/\D/g,"1")),t(a.val())}),n(".join-select").find("a").on("click",function(){var a=n(this),i=1;if(a.hasClass("minus"))i=Number(a.next('input[name="amount"]').val()),"NaN"!=i.toString()&&i>1&&a.next('input[name="amount"]').val(i-1);else{i=Number(a.prev('input[name="amount"]').val());var o=Number(a.data("max"));"NaN"!=i.toString()&&i<o&&a.prev('input[name="amount"]').val(i+1)}t(n('input[name="amount"]').val())}),n(".count-list").find("span").on("click",function(){var a=n(this),t=n('input[name="amount"]');a.closest(".count-list").find("span").removeClass("active"),a.addClass("active"),t.val(a.data("value"))}),n(".submit-btn").on("click",function(){return o()?!!i()&&void 0:(location.href="/login?next="+location.href,!1)}),n(document).ready(function(){var t=n(".join-body"),i=t.data("pid"),o="/api/v1.0/period_join_record?pid="+i;a.load_list(o,t,"period_join_item_tpl")}),n(".scroll-top").on("click",function(){var a=n(window).scrollTop();a>=50&&n("html,body").animate({scrollTop:0},"slow")})});